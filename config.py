"""
FAQ Bot 設定ファイル

このファイルには、アプリケーション全体で使用される定数と設定を定義します。
環境変数から取得する設定と、固定の設定値を管理します。
"""

import os
from dotenv import load_dotenv

# 環境変数の読み込み
load_dotenv()

# =============================================================================
# Slack設定
# =============================================================================
SLACK_BOT_TOKEN = os.getenv("SLACK_BOT_TOKEN")
SLACK_APP_TOKEN = os.getenv("SLACK_APP_TOKEN")

# =============================================================================
# API設定
# =============================================================================
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
GOOGLE_API_KEY = os.getenv("GOOGLE_API_KEY")

# =============================================================================
# ベクトルDB設定
# =============================================================================
CHROMA_DB_DIR = "./chroma_db_openai"

# =============================================================================
# 検索設定
# =============================================================================
# 検索結果の上位件数（適用除外規定なども確実に拾うため多めに設定）
TOP_K_RESULTS = 10

# メタデータフィルタリング用の取得倍率
SEARCH_MULTIPLIER = 3

# =============================================================================
# 質問具体化設定
# =============================================================================
# 追加質問の最大数
MAX_CLARIFYING_QUESTIONS = 3

# LLM温度設定
CLARITY_CHECK_TEMPERATURE = 0.1  # 判定用（厳格）
ANSWER_GENERATION_TEMPERATURE = 0.2  # 回答生成用

# =============================================================================
# 法律マッピング
# =============================================================================
# 法律の種類マッピング（ボタンアクションIDと表示名）
LAW_TYPES = {
    "keihyouhou": "景表法",
    "shikin_kessai": "資金決済法",
    "kojin_jouhou": "個人情報保護法",
    "inshi_zei": "印紙税法"
}

# 法律とソースファイルのマッピング（メタデータフィルタリング用）
LAW_SOURCE_MAPPING = {
    "景表法": [
        "不当景品類及び不当表示防止法.pdf",
        "不当景品類及び不当表示防止法施行規則.pdf",
        "景品に関するQ&A.pdf"
    ],
    "資金決済法": [
        "資金決済に関する法律.pdf",
        "資金決済に関する法律施行令.pdf",
        "前払式支払手段についてよくあるご質問231027.pdf"
    ],
    "個人情報保護法": [
        "個人情報の保護に関する法律.pdf",
        "個人情報の保護に関する法律についてのガイドライン（通則編）.pdf",
        "個人情報の保護に関する法律についてのガイドライン （仮名加工情報・匿名加工情報編）.pdf",
        "個人情報の保護に関する法律についてのガイドライン （第三者提供時の確認・記録義務編）.pdf",
        "「個人情報の保護に関する法律についてのガイドライン」 に関するＱ＆Ａ.pdf"
    ],
    "印紙税法": [
        "印紙税法.pdf",
        "印紙一覧.pdf"
    ]
}

# =============================================================================
# LLMモデル設定
# =============================================================================
EMBEDDING_MODEL = "text-embedding-3-large"
GENERATION_MODEL = "gemini-2.5-flash"

# =============================================================================
# プロンプトファイルパス
# =============================================================================
PROMPT_DIR = "./prompts"
CLARITY_CHECK_PROMPT_FILE = f"{PROMPT_DIR}/clarity_check.txt"
CLARITY_RECHECK_PROMPT_FILE = f"{PROMPT_DIR}/clarity_recheck.txt"
ANSWER_GENERATION_PROMPT_FILE = f"{PROMPT_DIR}/answer_generation.txt"

# =============================================================================
# Docker/ヘルスチェック設定
# =============================================================================
HEALTH_CHECK_FILE = "/tmp/bot_ready"

